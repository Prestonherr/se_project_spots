!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=(e,t,r)=>{const o=t.id+"-error";e.querySelector("#"+o).textContent="",t.classList.remove(r.inputErrorClass)},o=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?n(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},n=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((t=>{((e,t)=>{const n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);o(n,a,t),n.forEach((s=>{s.addEventListener("input",(function(){((e,t,o)=>{console.log(t.validationMessage),t.validity.valid?r(e,t,o):((e,t,r,o)=>{const n=t.id+"-error";e.querySelector("#"+n).textContent=r,t.classList.add(o.inputErrorClass)})(e,t,t.validationMessage,o)})(e,s,t),o(n,a,t)}))}))})(t,e)}))};function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?o:r}a(t);var c=e+"d73f076c46eb5467f5fc.svg",l=e+"d3610e9c6dce3cb370d8.svg",i=e+"2fc47fd8e9a9bcd9612f.jpg",d=e+"d38272e02bb4f1ab1c37.svg",u=e+"40608da7369d39bc1077.svg";const m=document.getElementById("avatar");m.src=i,document.getElementById("logo").src=l,document.getElementById("pencil-icon").src=d,document.getElementById("plus-icon").src=u,document.getElementById("profile__pencil-light").src=c;const _=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r}getAppInfo(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{headers:this._headers})}editUserInfo(e){let{name:t,about:r}=e;return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})})}editAvatarInfo(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}postNewCard(e){let{name:t,link:r}=e;return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}changeLikeStatus(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"0f6138b5-8fc9-4c68-90b7-4fd691cce345","Content-Type":"application/json"}});_.getAppInfo().then((e=>{let[t,r]=e;m.src=t.avatar,p.textContent=t.name,q.textContent=t.about,r.forEach((e=>{const t=Q(e);F.append(t)}))})).catch(console.error);const v=document.querySelector("#preview-modal"),h=v.querySelector(".modal__image"),S=v.querySelector(".modal__caption"),y=v.querySelector(".modal__close-button"),f=document.querySelector(".profile__edit-button"),b=document.querySelector(".profile__add-button"),p=document.querySelector(".profile__name"),q=document.querySelector(".profile__description"),g=document.querySelector(".profile__avatar-btn"),E=document.querySelector("#edit-profile-modal"),k=E.querySelector(".modal__form"),L=E.querySelector(".modal__close-button"),C=E.querySelector("#profile-name-input"),I=E.querySelector("#profile-description-input"),U=E.querySelector(".modal__submit-button"),x=document.querySelector("#avatar-modal"),A=x.querySelector(".modal__form"),B=x.querySelector(".modal__submit-button"),D=x.querySelector(".modal__close-button"),$=x.querySelector("#profile-avatar-input"),w=document.querySelector("#delete-modal"),T=w.querySelector(".modal__form"),N=w.querySelector(".modal__close-button"),P=document.getElementById("delete-cancel-btn"),j=document.querySelector("#add-card-modal"),O=j.querySelector(".modal__close-button"),J=j.querySelector(".modal__form"),H=j.querySelector(".modal__submit-button"),M=j.querySelector("#add-card-name-input"),R=j.querySelector("#add-card-link-input"),z=document.querySelector("#card-template"),F=document.querySelector(".cards__list");let G,K;function Q(e){const t=z.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,o.addEventListener("click",(()=>{V(v),h.src=e.link,h.alt=e.name,S.textContent=e.name})),e.isLiked?n.classList.add("card__like-button_liked"):n.classList.remove("card__like-button_liked"),n.addEventListener("click",(()=>{const t=n.classList.contains("card__like-button_liked");_.changeLikeStatus(e._id,t).then((e=>{e.isLiked?n.classList.add("card__like-button_liked"):n.classList.remove("card__like-button_liked")})).catch(console.error)})),a.addEventListener("click",(()=>{G=t,K=e._id,V(w)})),t}function V(e){e.classList.add("modal_opened"),document.addEventListener("keydown",Y)}function W(e){e.classList.remove("modal_opened"),document.removeEventListener("keydown",Y)}function X(e){e.target.classList.contains("modal_opened")&&W(e.target)}function Y(e){if("Escape"===e.key){const e=document.querySelector(".modal_opened");e&&W(e)}}T.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;s(t,!0,"Delete","Deleting..."),_.deleteCard(K).then((()=>{G.remove(),W(w)})).catch(console.error).finally((()=>{s(t,!1,"Delete","Deleting...")}))})),f.addEventListener("click",(()=>{var e,o;I.value=q.textContent,C.value=p.textContent,e=k,o=t,[I,C].forEach((t=>{r(e,t,o)})),V(E)})),L.addEventListener("click",(()=>{W(E)})),b.addEventListener("click",(()=>{V(j)})),O.addEventListener("click",(()=>{W(j)})),y.addEventListener("click",(()=>{W(v)})),g.addEventListener("click",(()=>{V(x)})),A.addEventListener("submit",(function(e){e.preventDefault();const r=e.submitter;s(r,!0,"Save","Saving..."),_.editAvatarInfo($.value).then((e=>{m.src=e.avatar,W(x),A.reset(),n(B,t)})).catch(console.error).finally((()=>{s(r,!1,"Save","Saving...")}))})),D.addEventListener("click",(()=>{W(x)})),N.addEventListener("click",(()=>{W(w)})),P.addEventListener("click",(()=>{W(w)})),document.querySelectorAll(".modal").forEach((e=>{e.addEventListener("mousedown",X)})),k.addEventListener("submit",(function(e){e.preventDefault();const r=e.submitter;s(r,!0,"Save","Saving..."),_.editUserInfo({name:C.value,about:I.value}).then((e=>{p.textContent=e.name,q.textContent=e.about,W(E),n(U,t)})).catch(console.error).finally((()=>{s(r,!1,"Save","Saving...")}))})),J.addEventListener("submit",(function(e){e.preventDefault();const r=e.submitter;s(r,!0,"Save","Saving...");const o={name:M.value,link:R.value};_.postNewCard(o).then((e=>{const r=Q(e);F.prepend(r),W(j),J.reset(),n(H,t)})).catch(console.error).finally((()=>{s(r,!1,"Save","Saving...")}))})),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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U0FBUzBILElBQzNDQSxFQUFNdEgsaUJBQWlCLFlBQWEwSCxFQUFtQixJQVl6RHZDLEVBQWdCbkYsaUJBQWlCLFVBMUlqQyxTQUE4QjhILEdBQzVCQSxFQUFJQyxpQkFFSixNQUFNQyxFQUFZRixFQUFJRyxVQUN0QjFILEVBQWN5SCxHQUFXLEVBQU0sT0FBUSxhQUV2Q3pHLEVBQ0d3QixhQUFhLENBQ1pFLEtBQU1vQyxFQUFtQitDLE1BQ3pCbEYsTUFBT29DLEVBQTBCOEMsUUFFbEN0RixNQUFNNEQsSUFDTHhDLEVBQVl6RixZQUFjaUksRUFBS3pELEtBQy9Ca0IsRUFBbUIxRixZQUFjaUksRUFBS3hELE1BQ3RDc0UsRUFBV3RDLEdBQ1g5RixFQUFjbUcsRUFBc0I1SCxFQUFTLElBRTlDOEcsTUFBTXZFLFFBQVF3RSxPQUNkd0QsU0FBUSxLQUNQM0gsRUFBY3lILEdBQVcsRUFBTyxPQUFRLFlBQVksR0FFMUQsSUFzSEE3QixFQUFtQm5HLGlCQUFpQixVQXBIcEMsU0FBNkI4SCxHQUMzQkEsRUFBSUMsaUJBRUosTUFBTUMsRUFBWUYsRUFBSUcsVUFDdEIxSCxFQUFjeUgsR0FBVyxFQUFNLE9BQVEsYUFFdkMsTUFBTU0sRUFBVyxDQUNmckYsS0FBTW9ELEVBQWlCK0IsTUFDdkJ6RSxLQUFNMkMsRUFBaUI4QixPQUd6QjdHLEVBQ0drQyxZQUFZNkUsR0FDWnhGLE1BQU15RixJQUNMLE1BQU1sRSxFQUFjQyxFQUFlaUUsR0FDbkNoRSxFQUFVaUUsUUFBUW5FLEdBQ2xCbUQsRUFBV3ZCLEdBQ1hFLEVBQW1Ca0MsUUFDbkJqSixFQUFjZ0gsRUFBa0J6SSxFQUFTLElBRTFDOEcsTUFBTXZFLFFBQVF3RSxPQUNkd0QsU0FBUSxLQUNQM0gsRUFBY3lILEdBQVcsRUFBTyxPQUFRLFlBQVksR0FFMUQsSUE4RkF6SSxFQUFpQjVCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcbn07XG5cbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgZXJyb3JNc2csIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1zZ0lEID0gaW5wdXRFbC5pZCArIFwiLWVycm9yXCI7XG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihcIiNcIiArIGVycm9yTXNnSUQpO1xuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gZXJyb3JNc2c7XG4gIGlucHV0RWwuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcbn07XG5cbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTXNnSUQgPSBpbnB1dEVsLmlkICsgXCItZXJyb3JcIjtcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKFwiI1wiICsgZXJyb3JNc2dJRCk7XG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcbiAgY29uc29sZS5sb2coaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSk7XG4gIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xuICAgIHNob3dJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgaW5wdXRFbC52YWxpZGF0aW9uTWVzc2FnZSwgY29uZmlnKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGNvbmZpZyk7XG4gIH1cbn07XG5cbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcbiAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xuICAgIHJldHVybiAhaW5wdXQudmFsaWRpdHkudmFsaWQ7XG4gIH0pO1xufTtcblxuY29uc3QgdG9nZ2xlQnV0dG9uU3RhdGUgPSAoaW5wdXRMaXN0LCBidXR0b25FbCwgY29uZmlnKSA9PiB7XG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWwsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWwuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWwsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbC5kaXNhYmxlZCA9IHRydWU7XG4gIGJ1dHRvbkVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xufTtcblxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XG4gIH0pO1xufTtcblxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsLnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xuICAgIH0pO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xuICAgIHNldEV2ZW50TGlzdGVuZXJzKGZvcm1FbCwgY29uZmlnKTtcbiAgfSk7XG59O1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KFxuICBidG4sXG4gIGlzTG9hZGluZyxcbiAgZGVmYXVsdFRleHQgPSBcIlNhdmVcIixcbiAgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXG4pIHtcbiAgaWYgKGlzTG9hZGluZykge1xuICAgIGJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICB9IGVsc2Uge1xuICAgIGJ0bi50ZXh0Q29udGVudCA9IGRlZmF1bHRUZXh0O1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IHtcbiAgZW5hYmxlVmFsaWRhdGlvbixcbiAgc2V0dGluZ3MsXG4gIHJlc2V0VmFsaWRhdGlvbixcbiAgZGlzYWJsZUJ1dHRvbixcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xuXG5pbXBvcnQgeyBzZXRCdXR0b25UZXh0IH0gZnJvbSBcIi4uL3V0aWxzL2hlbHBlcnMuanNcIjtcblxuaW1wb3J0IHBlbmNpbExpZ2h0SWNvbiBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC1saWdodC5zdmdcIjtcbmltcG9ydCBsb2dvU3JjIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcbmltcG9ydCBhdmF0YXJTcmMgZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XG5pbXBvcnQgcGVuY2lsSWNvbiBmcm9tIFwiLi4vaW1hZ2VzL3BlbmNpbC5zdmdcIjtcbmltcG9ydCBwbHVzSWNvbiBmcm9tIFwiLi4vaW1hZ2VzL3BsdXMuc3ZnXCI7XG5cbmNvbnN0IGF2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImF2YXRhclwiKTtcbmF2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyU3JjO1xuY29uc3QgbG9nb0VsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ29cIik7XG5sb2dvRWxlbWVudC5zcmMgPSBsb2dvU3JjO1xuXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBlbmNpbC1pY29uXCIpLnNyYyA9IHBlbmNpbEljb247XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsdXMtaWNvblwiKS5zcmMgPSBwbHVzSWNvbjtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicHJvZmlsZV9fcGVuY2lsLWxpZ2h0XCIpLnNyYyA9IHBlbmNpbExpZ2h0SWNvbjtcblxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7XG5cbi8vIGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiVmFsIFRob3JlbnNcIixcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMS1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIlJlc3RhdXJhbnQgdGVycmFjZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8yLXBob3RvLWJ5LWNlaWxpbmUtZnJvbS1wZXhlbHMuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkFuIG91dGRvb3IgY2FmZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy8zLXBob3RvLWJ5LXR1YmFudXItZG9nYW4tZnJvbS1wZXhlbHMuanBnXCIsXG4vLyAgIH0sXG4vLyAgIHtcbi8vICAgICBuYW1lOiBcIkEgdmVyeSBsb25nIGJyaWRnZSwgb3ZlciB0aGUgZm9yZXN0IGFuZCB0aHJvdWdoIHRoZSB0cmVlc1wiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy80LXBob3RvLWJ5LW1hdXJpY2UtbGFzY2hldC1mcm9tLXBleGVscy5qcGdcIixcbi8vICAgfSxcbi8vICAge1xuLy8gICAgIG5hbWU6IFwiVHVubmVsIHdpdGggbW9ybmluZyBsaWdodFwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy81LXBob3RvLWJ5LXZhbi1hbmgtbmd1eWVuLWZyb20tcGV4ZWxzLmpwZ1wiLFxuLy8gICB9LFxuLy8gICB7XG4vLyAgICAgbmFtZTogXCJNb3VudGFpbiBob3VzZVwiLFxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy82LXBob3RvLWJ5LW1vcml0ei1mZWxkbWFubi1mcm9tLXBleGVscy5qcGdcIixcbi8vICAgfSxcbi8vIF07XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjBmNjEzOGI1LThmYzktNGM2OC05MGI3LTRmZDY5MWNjZTM0NVwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmFwaVxuICAuZ2V0QXBwSW5mbygpXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xuICAgIGF2YXRhckVsZW1lbnQuc3JjID0gdXNlckRhdGEuYXZhdGFyO1xuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcblxuICAgIGNhcmRzLmZvckVhY2goKGNhcmQpID0+IHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XG4gICAgICBjYXJkc0xpc3QuYXBwZW5kKGNhcmRFbGVtZW50KTtcbiAgICB9KTtcbiAgfSlcbiAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuXG4vLyBNb2RhbCBTZWxlY3Rpb25cbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbEltYWdlRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uRWwgPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbmNvbnN0IHByZXZpZXdNb2RhbENsb3NlQnV0dG9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxuKTtcblxuLy8gUHJvZmlsZSBlbGVtZW50c1xuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgbmV3UG9zdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbmNvbnN0IGF2YXRhck1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnRuXCIpO1xuXG4vLyBGb3JtIGVsZW1lbnRzXG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XG5jb25zdCBlZGl0Rm9ybUVsZW1lbnQgPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBlZGl0Q2xvc2VCdXR0b24gPSBlZGl0UHJvZmlsZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1uYW1lLWlucHV0XCJcbik7XG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZWRpdFByb2ZpbGVNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5jb25zdCBlZGl0UHJvZmlsZVN1Ym1pdEJ0biA9IGVkaXRQcm9maWxlTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIlxuKTtcblxuLy8gQXZhdGFyIGZvcm0gZWxlbWVudHNcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGF2YXRhclN1Ym1pdEJ0biA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIik7XG5jb25zdCBhdmF0YXJNb2RhbENsb3NlQnRuID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuY29uc3QgYXZhdGFySW5wdXQgPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYXZhdGFyLWlucHV0XCIpO1xuXG4vLyBEZWxldGUgZm9ybSBlbGVtZW50c1xuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcbmNvbnN0IGRlbGV0ZUZvcm0gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgZGVsZXRlRm9ybUNsb3NlQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xuY29uc3QgZGVsZXRlQ2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJkZWxldGUtY2FuY2VsLWJ0blwiKTtcblxuLy8gQ2FyZCBlbGVtZW50c1xuY29uc3QgY2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGNhcmRNb2RhbENsb3NlQnV0dG9uID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgYWRkQ2FyZFN1Ym1pdEJ0biA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuY29uc3QgYWRkQ2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XG5jb25zdCBhZGRDYXJkTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5cbmxldCBzZWxlY3RlZENhcmQsIHNlbGVjdGVkQ2FyZElkO1xuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICBjb25zdCBjYXJkTmFtZUVsID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICBjb25zdCBjYXJkTGlrZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gIGNvbnN0IGNhcmREZWxldGVCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XG5cbiAgY2FyZE5hbWVFbC50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgY2FyZEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xuICBjYXJkSW1hZ2VFbC5hbHQgPSBkYXRhLm5hbWU7XG5cbiAgY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3TW9kYWxDYXB0aW9uRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gIH0pO1xuXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcbiAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XG4gIH0gZWxzZSB7XG4gICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuICB9XG5cbiAgY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjb25zdCBpc0xpa2VkID0gY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFxuICAgICAgXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiXG4gICAgKTtcblxuICAgIGFwaVxuICAgICAgLmNoYW5nZUxpa2VTdGF0dXMoZGF0YS5faWQsIGlzTGlrZWQpXG4gICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcbiAgICAgICAgaWYgKHVwZGF0ZWRDYXJkLmlzTGlrZWQpIHtcbiAgICAgICAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIEFkZCBsaWtlIGNvdW50ZXI/XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICB9KTtcblxuICBjYXJkRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XG4gICAgc2VsZWN0ZWRDYXJkSWQgPSBkYXRhLl9pZDtcbiAgICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xuICB9KTtcblxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLmRlbGV0ZUNhcmQoc2VsZWN0ZWRDYXJkSWQpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XG4gICAgfSk7XG59XG5cbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xuXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlS2V5KTtcbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVLZXkpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUsIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcblxuICBhcGlcbiAgICAuZWRpdFVzZXJJbmZvKHtcbiAgICAgIG5hbWU6IGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSxcbiAgICAgIGFib3V0OiBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlLFxuICAgIH0pXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5hYm91dDtcbiAgICAgIGNsb3NlTW9kYWwoZWRpdFByb2ZpbGVNb2RhbCk7XG4gICAgICBkaXNhYmxlQnV0dG9uKGVkaXRQcm9maWxlU3VibWl0QnRuLCBzZXR0aW5ncyk7XG4gICAgfSlcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UsIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChldnQpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUsIFwiU2F2ZVwiLCBcIlNhdmluZy4uLlwiKTtcblxuICBjb25zdCBjYXJkRGF0YSA9IHtcbiAgICBuYW1lOiBhZGRDYXJkTmFtZUlucHV0LnZhbHVlLFxuICAgIGxpbms6IGFkZENhcmRMaW5rSW5wdXQudmFsdWUsXG4gIH07XG5cbiAgYXBpXG4gICAgLnBvc3ROZXdDYXJkKGNhcmREYXRhKVxuICAgIC50aGVuKChuZXdDYXJkKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KG5ld0NhcmQpO1xuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xuICAgICAgYWRkQ2FyZEZvcm1FbGVtZW50LnJlc2V0KCk7XG4gICAgICBkaXNhYmxlQnV0dG9uKGFkZENhcmRTdWJtaXRCdG4sIHNldHRpbmdzKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCBmYWxzZSwgXCJTYXZlXCIsIFwiU2F2aW5nLi4uXCIpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJTdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XG4gIHNldEJ1dHRvblRleHQoc3VibWl0QnRuLCB0cnVlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG5cbiAgYXBpXG4gICAgLmVkaXRBdmF0YXJJbmZvKGF2YXRhcklucHV0LnZhbHVlKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBhdmF0YXJFbGVtZW50LnNyYyA9IGRhdGEuYXZhdGFyO1xuICAgICAgY2xvc2VNb2RhbChhdmF0YXJNb2RhbCk7XG4gICAgICBhdmF0YXJGb3JtLnJlc2V0KCk7XG4gICAgICBkaXNhYmxlQnV0dG9uKGF2YXRhclN1Ym1pdEJ0biwgc2V0dGluZ3MpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlLCBcIlNhdmVcIiwgXCJTYXZpbmcuLi5cIik7XG4gICAgfSk7XG59XG5cbi8vIGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4vLyAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuLy8gICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XG4vLyAgIH0pO1xuLy8gfTtcblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XG4gIHJlc2V0VmFsaWRhdGlvbihcbiAgICBlZGl0Rm9ybUVsZW1lbnQsXG4gICAgW2VkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQsIGVkaXRNb2RhbE5hbWVJbnB1dF0sXG4gICAgc2V0dGluZ3NcbiAgKTtcbiAgb3Blbk1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xufSk7XG5cbmVkaXRDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGVkaXRQcm9maWxlTW9kYWwpO1xufSk7XG5cbm5ld1Bvc3RCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKGNhcmRNb2RhbCk7XG59KTtcblxuY2FyZE1vZGFsQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xufSk7XG5cbnByZXZpZXdNb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwocHJldmlld01vZGFsKTtcbn0pO1xuXG5hdmF0YXJNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xufSk7XG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQXZhdGFyU3VibWl0KTtcblxuYXZhdGFyTW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcbn0pO1xuXG5kZWxldGVGb3JtQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XG59KTtcblxuZGVsZXRlQ2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZU92ZXJsYXlDbGljayhldmVudCkge1xuICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgIGNsb3NlTW9kYWwoZXZlbnQudGFyZ2V0KTtcbiAgfVxufVxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsXCIpLmZvckVhY2goKG1vZGFsKSA9PiB7XG4gIG1vZGFsLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVFc2NhcGVLZXkoZXZlbnQpIHtcbiAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgIGNvbnN0IG9wZW5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuICAgIGlmIChvcGVuTW9kYWwpIHtcbiAgICAgIGNsb3NlTW9kYWwob3Blbk1vZGFsKTtcbiAgICB9XG4gIH1cbn1cblxuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlRWRpdEZvcm1TdWJtaXQpO1xuYWRkQ2FyZEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuIiwiY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcbiAgfVxuXG4gIGdldEFwcEluZm8oKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcbiAgfVxuXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xuICAgIGlmIChyZXMub2spIHtcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgIH1cbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lLFxuICAgICAgICBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgZWRpdEF2YXRhckluZm8oYXZhdGFyKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIHBvc3ROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICBjaGFuZ2VMaWtlU3RhdHVzKGlkLCBpc0xpa2VkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQXBpO1xuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRWwiLCJpbnB1dEVsIiwiY29uZmlnIiwiZXJyb3JNc2dJRCIsImlkIiwicXVlcnlTZWxlY3RvciIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbCIsInNvbWUiLCJpbnB1dCIsInZhbGlkaXR5IiwidmFsaWQiLCJoYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJhZGQiLCJlbmFibGVWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInNldEV2ZW50TGlzdGVuZXJzIiwiYnV0dG9uRWxlbWVudCIsImlucHV0RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJjb25zb2xlIiwibG9nIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTXNnIiwic2V0QnV0dG9uVGV4dCIsImJ0biIsImlzTG9hZGluZyIsImRlZmF1bHRUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwibG9hZGluZ1RleHQiLCJhdmF0YXJFbGVtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzcmMiLCJhdmF0YXJTcmMiLCJsb2dvU3JjIiwicGVuY2lsSWNvbiIsInBsdXNJY29uIiwicGVuY2lsTGlnaHRJY29uIiwiYXBpIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0VXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsIl9yZXF1ZXN0IiwidXJsIiwib3B0aW9ucyIsImZldGNoIiwidGhlbiIsImVkaXRVc2VySW5mbyIsIl9yZWYyIiwibmFtZSIsImFib3V0IiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZGl0QXZhdGFySW5mbyIsImF2YXRhciIsInBvc3ROZXdDYXJkIiwiX3JlZjMiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsImNoYW5nZUxpa2VTdGF0dXMiLCJpc0xpa2VkIiwiYXV0aG9yaXphdGlvbiIsInVzZXJEYXRhIiwiY2FyZHMiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsImNhcmQiLCJjYXJkRWxlbWVudCIsImdldENhcmRFbGVtZW50IiwiY2FyZHNMaXN0IiwiYXBwZW5kIiwiY2F0Y2giLCJlcnJvciIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbEltYWdlRWwiLCJwcmV2aWV3TW9kYWxDYXB0aW9uRWwiLCJwcmV2aWV3TW9kYWxDbG9zZUJ1dHRvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwibmV3UG9zdEJ1dHRvbiIsImF2YXRhck1vZGFsQnRuIiwiZWRpdFByb2ZpbGVNb2RhbCIsImVkaXRGb3JtRWxlbWVudCIsImVkaXRDbG9zZUJ1dHRvbiIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJlZGl0UHJvZmlsZVN1Ym1pdEJ0biIsImF2YXRhck1vZGFsIiwiYXZhdGFyRm9ybSIsImF2YXRhclN1Ym1pdEJ0biIsImF2YXRhck1vZGFsQ2xvc2VCdG4iLCJhdmF0YXJJbnB1dCIsImRlbGV0ZU1vZGFsIiwiZGVsZXRlRm9ybSIsImRlbGV0ZUZvcm1DbG9zZUJ0biIsImRlbGV0ZUNhbmNlbEJ1dHRvbiIsImNhcmRNb2RhbCIsImNhcmRNb2RhbENsb3NlQnV0dG9uIiwiYWRkQ2FyZEZvcm1FbGVtZW50IiwiYWRkQ2FyZFN1Ym1pdEJ0biIsImFkZENhcmROYW1lSW5wdXQiLCJhZGRDYXJkTGlua0lucHV0IiwiY2FyZFRlbXBsYXRlIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJkYXRhIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmROYW1lRWwiLCJjYXJkSW1hZ2VFbCIsImNhcmRMaWtlQnV0dG9uIiwiY2FyZERlbGV0ZUJ1dHRvbiIsImFsdCIsIm9wZW5Nb2RhbCIsImNvbnRhaW5zIiwiX2lkIiwidXBkYXRlZENhcmQiLCJtb2RhbCIsImhhbmRsZUVzY2FwZUtleSIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaGFuZGxlT3ZlcmxheUNsaWNrIiwiZXZlbnQiLCJ0YXJnZXQiLCJrZXkiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdEJ0biIsInN1Ym1pdHRlciIsImZpbmFsbHkiLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZSIsInJlc2V0IiwiY2FyZERhdGEiLCJuZXdDYXJkIiwicHJlcGVuZCJdLCJzb3VyY2VSb290IjoiIn0=